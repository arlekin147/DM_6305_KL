#include <iostream>
#include "conio.h"
using namespace std;

typedef struct N { //Структура содержит данные о длинном натуральном числе
	int n; //Старший разряд числа
	int *A; //Массив цифр
}N;
int COM_NN_D(N Num1, N Num2){ //Модуль N1. Разработал Буракаев Данияр.Затраченное время : ~15 минут 
	int i;
	if (Num1.n > Num2.n) return 2; //Если в первом числе больше старший разряд , то оно больше
	else if (Num1.n == Num2.n){ // Если старшие разряды равны , то сравниваем цифры
		i = Num1.n; //Начиная со старшего разряда
		while (i != (-1)){ //Пока разряды не закончились
			if (Num1.A[i] > Num2.A[i]) { return 2; } //Если первая их различная цифра у первого больше , то больше первое 
			else if (Num2.A[i] > Num1.A[i]) { return 1; } //Если у второго , то второе
			else{ i--; }
		}
		return 0; // Если все цифры равны , то и числа равны
	}
	else return 1;//Если старший разряд больше во втором числе , то больше второе
}

int NZER_N_B(N Num){ //Модуль N2. Разработал Сапожников Евгений. Затраченное время : ~8 минут Проверено
	if (Num.A[Num.n] == 0) return 0; //Если цифра в старшем разряде равна нулю , то число равно нулю
	else return 1; //Иначе не ноль
}

N ADD_1N_N(N Num){//Модуль N3 Разработала Таиссия Смирнова.Затраченное время ~1,5 часа
	N new_Num;
	new_Num.A = NULL;
	new_Num.n = 0;
	int flag,i;
	i = 0;
	flag = 0;

	while (flag == 0){
		if (Num.A[i] + 1 == 10) {//
			cout << 1 << endl;
			new_Num.A = (int*)realloc(new_Num.A,(i + 1)*sizeof(int));
			new_Num.A[i] = 0;
			new_Num.n++;
		}
		else{
			cout << 2 << endl;
			new_Num.A[i] = Num.A[i] + 1;
			flag = 1;
		}
		i++;
		

	}
	return new_Num;
}

N ADD_NN_N(N Num1, N Num2){ //Модуль N4 . Разработал Буракаев Данияр . Затраченное время ~45 минут
	N Num3 ,time;
	int i,max,min,flag;
	flag = COM_NN_D(Num1, Num2);
	if (flag == 1) {
		time = Num2;
		Num2 = Num1;
		Num1 = time;
	}
	Num3 = Num1;
	Num3.A = (int*)realloc(Num3.A, (Num3.n + 1)*sizeof(int));
	Num3.A[(Num3.n+1)] = 0;
	Num3.n++;
	i = 0;
	while (i != ((Num2.n)+1)){
		Num3.A[i] += Num2.A[i];
		if (Num3.A[i] / 10 != 0){
			Num3.A[i + 1]++;
			Num3.A[i] %= 10;
		}
		i++;
	}
	if (Num3.A[Num3.n] == 0) {
		Num3.A = (int*)realloc(Num3.A, (Num3.n)*sizeof(int));
		Num3.n--;
	}
	
	return Num3;
}

N SUB_NN_N(N Num1, N Num2){//Модуль N5. Разработал Евгений Сапожников.Затраченное время ~25 минут
	int flag,i;
	N new_Num;
	new_Num.n = Num1.n;
	new_Num.A = NULL;
	for (i = 0; i <= Num1.n; i++){
		new_Num.A = (int*)realloc(new_Num.A, (i + 1)*sizeof(int));
		new_Num.A[i] = Num1.A[i];
	}
	flag = COM_NN_D(new_Num, Num2);
	i = 0;
	if (flag == 1){
		new_Num.A = (int*)malloc(sizeof(int));
		new_Num.A[0] = 0;
		new_Num.n = 0;
		return new_Num;
	}
	else{
		i = 0;
		while (i <= Num2.n){
			if (new_Num.A[i] < Num2.A[i]) {
				new_Num.A[i + 1]--;
				new_Num.A[i] += 10;

			}
			new_Num.A[i] -= Num2.A[i];
			i++;
		}
	
	}
	i = new_Num.n;
	if (new_Num.A[i] == 0){
		new_Num.A = (int*)realloc(new_Num.A, (new_Num.n--)*sizeof(int));
		i--;
	}
	return new_Num;
}



N MUL_ND_N(N Num, int  digit){//Модуль N6 . Разработала Таисия Смирнова . Затраченное время ~1 час
	int i,time=0,flag=0;
	N new_Num;
	new_Num.n = Num.n;
	new_Num.A = NULL;
	for (i = 0; i <= Num.n; i++){
		new_Num.A = (int*)realloc(new_Num.A, (i + 1)*sizeof(int));
		new_Num.A[i] = Num.A[i];
	}
	i = 0;
	while (i<= new_Num.n){
		new_Num.A[i] = (new_Num.A[i] * digit) + time;
		if (new_Num.A[i] >= 10){
			time = new_Num.A[i] / 10;
			new_Num.A[i] %= 10;
			if (i == new_Num.n) {
				new_Num.A = (int*)realloc(new_Num.A, (new_Num.n + 2)*sizeof(int));
			}
		}
		i++;
	}
	new_Num.A[i] = time;
	new_Num.n = Num.n + 1;
	return new_Num;
}


N MUL_Nk_N(N Num, int deg){ //Модуль N7. Разработал Буракаев Данияр. Затраченное время ~10 минут
	N new_Num;
	int i;
	new_Num.n =Num.n+ deg;
	new_Num.A = (int*)malloc((new_Num.n + deg+1)*sizeof(int));
	i = 0;
	while (i != deg){
		new_Num.A[i] = 0;
		i++;
	}
	while (i <= new_Num.n){
		new_Num.A[i] = Num.A[i - deg];
		i++;
	}

	return new_Num;
}

N MUL_NN_N(N Num1, N Num2){//Модуль N8 . Разработал Евгений Гонштейн.Затраченное время ~5 минут
	int i=0,j;
	N Num3,p,p1,p2;
	Num3.A = (int*)malloc(sizeof(int));
	Num3.A[0] = 0;
	Num3.n = 0;
	while (i <= Num2.n){
		p2 = MUL_ND_N(Num1, Num2.A[i]);
		/*for (j = p2.n; j >= 0; j--) cout << p2.A[j];
		cout << endl;*/
		p1 = MUL_Nk_N(p2, i);
		for (j = p1.n; j >= 0; j--) cout << p1.A[j];
		cout << endl;
		Num3 = ADD_NN_N(Num3,p1);
		i++;
	}
	return Num3;
}

N SUB_NDN_N(N Num1, N Num2, int digit){//Модуль N9. Разработала Таисия Смирнова.Затраченное время ~1,5 часа
	int flag,i;
	N new_Num2,new_Num;
	new_Num2 = MUL_ND_N(Num2, digit);
	for (i = new_Num2.n; i >= 0; i--) cout << new_Num2.A[i];
	cout << endl;
	if (COM_NN_D(Num1, new_Num2) == 1) {
		new_Num.A = (int*)malloc(sizeof(int));
		new_Num.A[0] = 0;
		new_Num.n = 0;
	}
	else{
		new_Num = SUB_NN_N(Num1, new_Num2); 
		for (i = Num1.n; i >= 0; i--) cout << Num1.A[i];
		cout << endl;
		for (i = new_Num2.n; i >= 0; i--) cout << new_Num2.A[i];
		cout << endl;
	}
	return new_Num;
}

N DIV_NN_Dk(N Num1, N Num2){//N10 Я без понятия , что он делает :( Разработала Тарасова Анна . Затраченное время ~?
	int flag, i;
	N time, Dif, result;
	result.n = 0;
	result.A = (int*)malloc(sizeof(int));
	flag = COM_NN_D(Num1, Num2);
	if (flag == 0) {
		result.A[0] = 1;
		i = Num1.n;
	}
	else {
		if (flag == 1){
			time = Num2;
			Num2 = Num1;
			Num1 = time;
		}
		Dif.A = NULL;
		Dif.n = Num2.n;
		i = 0;
		result.A[0] = 0;
		while (i < Num2.n){
			Dif.A = (int*)realloc(Dif.A, (i + 1)*sizeof(int));
			Dif.A[i] = Num2.A[i];
			i++;
		}
		if (COM_NN_D(Dif, Num2)==1){
			i++;
			Dif.n = i;
			Dif.A = (int*)realloc(Dif.A, (i + 1)*sizeof(int));
			Dif.A[i] = Num2.A[i];
			i++;
		}
		do{
			result = ADD_1N_N(result);

			Dif = SUB_NN_N(Dif, Num2);
		} while (COM_NN_D(Dif, Num2) != 1);
		result = MUL_Nk_N(result, Num1.n - i);
	}
	return result;
}

N DIV_NN_N(N Num1, N Num2){ //Модуль N11 Разработала Вдовиченко Лера.Затраченное время ~40 минут
	N time,q;
	q.n = 0;
	q.A = (int*)malloc(sizeof(int));
	q.A[0] = 0;
	int i;
	if (COM_NN_D(Num1,Num2) == 1) {
		time = Num2;
		Num2 = Num1;
		Num1 = time;
	}
	time.n = Num1.n;
	time.A = (int*)malloc((time.n + 1)*sizeof(int));
	for (i = 0; i <= Num1.n; i++) time.A[i] = Num1.A[i];
	i = 0;
	while (COM_NN_D(time, Num2) != 1){
		time=SUB_NN_N(time, Num2);
		/*for (i = time.n; i >= 0; i--) cout << time.A[i];			Это хлам . 
		cout << endl;*/
		q=ADD_1N_N(q);
		/*for (i = q.n; i >= 0; i--) cout <<"q "<<  q.A[i];
		cout << endl;*/
	}
	return q;
}

N MOD_NN_N(N Num1, N Num2){//Модуль N12 . Разработала Вдовиченко Лера.Затраченное время ~10 минут.
	N r;
	r.n = 0;
	r.A = (int*)malloc(sizeof(int));// С 11 будет работать
	r.A[0] = 0;
	r = SUB_NN_N(Num1, MUL_NN_N(DIV_NN_N(Num1, Num2),Num2));
	return r;
}
N GCF_NN_N(N Num1, N Num2){ //Модуль N13 . Разработала Вдовиченко Лера. Затраченное время ~?.
	N NOD;
	if (COM_NN_D(Num1, Num2) == 0) return  Num1;
	while (NZER_N_B(Num1) && NZER_N_B(Num2)){
		if (COM_NN_D(Num1, Num2) == 2){		
			Num1 = MOD_NN_N(Num1, Num2);
		}
		else{
			Num2 = MOD_NN_N(Num1, Num2);
		}
	}
	NOD = ADD_NN_N(Num1, Num2);
	return NOD;
}

N LCM_NN_N(){//N14 Никто не разработал :(

}
